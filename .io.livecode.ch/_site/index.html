{% extends "base_livecode.html" %}

{% block title %}Scheme Mechanics{% endblock %}

{% block content %}
<script>
function livecode_html_extra(id) {
  return '<div class=boxit id='+'boxit-'+id+'></div>'
}
function livecode_process_data(id, data) {
  var tex = /<exp>\\boxit\{(.*?)\}<\/exp>/g;
  var m;
  var a = [];
  while ((m = tex.exec(data)) !== null) {
    a.push('<p>'+m[1]+'</p>');
  }
  if (a.length==0) return data;
  $('#boxit-'+id).html(a.join('\n'));
  MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
  return "";
}
</script>
<div class="live hidden" id="lib">
(define (html-show-expression x)
  (display (string-append "&lt;exp&gt;" (expression->tex-string x) "&lt;/exp&gt;")))
</div>
<div class="live norun" id="ex">
(define (Lagrange-eq L q)
  (- (D (compose ((partial 2) L) (Gamma q)))
     (compose ((partial 1) L) (Gamma q))))

(define (V x y)
  (+ (/ (+ (square x) (square y)) 2)
     (* (square x) y)
     (- (/ (cube y) 3))))

(define ((L m) local)
  (let ((vx (ref (velocity local) 0))
        (vy (ref (velocity local) 1))
        ( x (ref (coordinate local) 0))
        ( y (ref (coordinate local) 1)))
    (- (/ (* m (+ (square vx) (square vy))) 2)
       (V x y))))

(define (q t)
  (up
   ((literal-function 'x) t)
   ((literal-function 'y) t)))
</div>

<div class="live" id="ex1" data-lib="lib ex">
(simplify ((Lagrange-eq (L 'm) q) 't))
</div>

<div class="live" id="ex2" data-lib="lib ex">
(html-show-expression (simplify ((Lagrange-eq (L 'm) q) 't)))
</div>
{% endblock %}
